/*! frontend 2021-09-10 */

(async()=>{$("#logoBtn").click(function(){window.location.href="index.html"}),$("#animalsBtn").click(function(){$([document.documentElement,document.body]).animate({scrollTop:$("#listingSection").offset().top},1500)}),$("#listingBtn").click(function(){window.location.href="listing.html"}),$("#user").click(function(){$("#headerPopover").fadeIn("slow"),$("#loginContent").css("display","flex"),$("#loginContent").hide(),$("#loginContent").fadeIn("slow"),$("#emptyCartContent").css("display","none"),$("#fullCartContent").css("display","none")}),$("#createAccountBtn").click(function(){$("#createAccountContent").css("display","flex"),$("#createAccountContent").hide(),$("#createAccountContent").fadeIn("slow"),$("#loginContent").css("display","none")}),$("#signUpBtn").click(function(){$("#loginContent").css("display","flex"),$("#loginContent").hide(),$("#loginContent").fadeIn("slow"),$("#createAccountContent").css("display","none")}),$("#cart").click(function(){$("#headerPopover").fadeIn("slow"),$("#emptyCartContent").css("display","flex"),$("#emptyCartContent").hide(),$("#emptyCartContent").fadeIn("slow"),$("#loginContent").css("display","none"),$("#createAccountContent").css("display","none")}),$("#popoverExit").click(function(){$("#headerPopover").fadeOut("slow"),$("#loginContent").fadeOut("slow"),$("#emptyCartContent").fadeOut("slow"),$("#fullCartContent").css("display","none"),$("#createAccountContent").fadeOut("slow")}),$("#popoverExit").click(function(){$("#headerPopover").fadeOut("slow"),$("#loginContent").css("display","none"),$("#cartContent").css("display","none")}),window.loggedIn=!1;let n=()=>{window.currentSession,window.sessionHeader=document.querySelector("#sessionHeader"),window.loginPopOver=document.querySelector(".header-popover"),window.usernameInput=document.querySelector("#username"),window.passwordInput=document.querySelector("#password"),window.loginButton=document.querySelector("#submitLogin"),window.createAccountButton=document.querySelector("#createAccountBtn"),window.closeLoginButton=document.querySelector(".popover-exit-btn"),window.cardParent=document.querySelector(".all-listings"),window.cards=document.querySelectorAll(".card")},e=()=>{currentSession=attemptedLogin,closeLoginButton.click(),loginButton.textContent="Log Out",sessionHeader.textContent=`User: ${currentSession}`,usernameInput.style.display="none",passwordInput.style.display="none",createAccountButton.style.display="none",loginPopOver.style.height="14%",loginPopOver.style.paddingBottom="30px"},t=()=>{currentSession=null,closeLoginButton.click(),loginButton.textContent="Log In",sessionHeader.textContent="Log In",usernameInput.style.display="block",passwordInput.style.display="block",createAccountButton.style.display="block",loginPopOver.style.height="50vh",loginPopOver.style.paddingBottom="0"};let o=async(...n)=>{var[e,t]=n;let o=await fetch(`/findUser?q=${e}`);n=await o.json(),t=void 0!==n[0]&&n[0].username===e&&n[0].password===t;return loggedIn&&i(),window.attemptedLogin=e,t},i=async()=>{if(n(),!loggedIn){if(await o(usernameInput.value,passwordInput.value))return e(),console.log("Signing in"),void(loggedIn=!0);alert("Incorrect login!")}loggedIn&&(t(),console.log("Signing out"),loggedIn=!1)};(async()=>{let n=await fetch("/findAnimal");var e=await n.json();cardParent.innerHTML="";for(card of e)cardParent.innerHTML+=`
                <div class="card">
                    <div class="top-info">
                        <div class="username">
                            <h6>John Doe</h6>
                        </div>
                        <div class="rating">
                            <h6>${card.rating}</h6>
                        </div>
                    </div>
                    <div class="card-img">
                        <button class="favourite" type="button" name="button"> <a class="fa fa-heart" href="#"></a> </button>
                        <img src="${card.url}" alt="">
                    </div>
                    <div class="bottom-info">
                        <div class="title">
                            <h5>${card.name}</h5>
                        </div>
                        <div class="price">
                            <h6>$${card.price.toLocaleString()}</h6>
                            </div>
                        </div>
                </div>
            `})(),n(),loginButton.addEventListener("click",async()=>{i()}),passwordInput.addEventListener("keydown",n=>{13===n.keyCode&&(n.preventDefault(),loginButton.click())})})();